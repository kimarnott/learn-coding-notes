---
tags:
  - day
  - web-dev/js/express
  - web-dev/js/express/middleware
  - web-dev/js/express/ejs
order: 28
aliases:
  - 28. APIs
complete: true
---
Application Programming Interfaces.

- [x] Concept
- [ ] Capstone
- [ ] Portfolio

# General
A set of rules and protocols defining how different software can interact with each other. An API bridges communication between different pieces of software.

Angela's API is short, simple, and covers the main points described here: [`http://bored-api.appbrewery.com`](http://bored-api.appbrewery.com) 

## Structure

Endpoints are fixed paths (they never change). Basically, look at the documentation to see which endpoints will give you the data you're looking for. Public APIs don't require any sort of authentication.

`https://<base-url>/<endpoint>?query=value&query2=value`

Query parameters start straight after the endpoint, with a `?` (use `&` to chain queries together) are useful for searching and filtering.

`<base-url>/<endpoint>/{path-parameter}`

Path parameters can change, and are useful for finding a specific resource. 

## JSON vs JS Object

Note that JavaScript object keys are *not* strings. In a JSON, the keys are strings.

![[JS Object vs JSON.png]]

JSONs can be flat-packed (on one line), if you get a flat JSON you can use something like [JSON Viewer](https://jsonviewer.stack.hu/)

> [!tip] To turn a JS Object into JSON
> `const jsonData = JSON.stringify(data);`

> [!tip] To unpack a JSON (into a JS Object)
> `const data = JSON.parse(jsonData);`

> [!note] Accessing Values
> You can reference a JS Object with dot notation.. i.e.
>
> `console.log(kim.name)`
>
>  Expected output: `Kim`.

## Server-Side API Requests with [[Axios]]

```js
import axios from "axios";

app.get("/", async (req, res) => {
  try {
    const response = await axios.get("https://bored-api.appbrewery.com/random")
    res.render("index.ejs", { activity: response.data });
  } catch (error) {
	console.error("Failed to make request: ", error.messasge);
	res.status(500).send("Failed to fetch activity.");
	}
});
```

Note that we don't need to use `JSON.parse('#')` on the data we get back with Axios, it know what's we're trying to do.

The `await` basically tells the computer to wait for the function to finish before executing the rest of the script.
## API Authentication

>[!tip]+ No Authentication
>- Though you don't check who's looking, you can put a rate limit (e.g. 100/15min), which checks how many times an IP address is requesting from an API.

>[!tip]+ Basic Authentication
>- Provide a username and password when you make your API request (you have an account with the API provider) - proving your identity.
>	- This is passed in the form `{Authorisation: Basic username:password}`
>	- Even though it's fairly easy to decode base64, most APIs use HTTPS on their domain, so its a bit more difficult to unscramble
>	- But it's still not the best idea to pass usernames and passwords through headers
>- The `{username:password}` is passed through the header in Base64 Encoding.
>```js
>axios.get(URL, {
>  auth: {
>    username: "abc",
>    password: "123",
>  },
>});
>```

>[!tip]+ API Key Authorisation
> *Authorisation*
>- could be associated with a user, but doesn't have to be
>- allows tracking per key (e.g. to let the owner know how much to charge you)
>- API keys can be easily reset
>- You can pay for different types of API keys (eg. one that lets you make 100 requests per month or 1000)

>[!tip]+ Token Based Authentication
> *Authentication* 
>- identify as a user - logging in or registering
>- A token is generated by a user (registered and logged in) on the API provider website, using their username and password
>- Bearer tokens do not change
>- OAuth is the industry standard
>- You can get a user to give your 3rd party app a token to use in your app - interconnectivity
>```js
>axios.get(URL, {
>  headers: {
>    Authorization: `Bearer <TOKEN>`
>  },
>});
>```


## REST APIs

>[!abstract]+ RESTful with AXIOS
>- `axios.get(URL, config)`
>- `axios.post(URL, body, config)`
>	- Where body is the data you're sending across (axios docs call it 'data')
>- `axios.put(URL, body, config)`
>- `axios.patch(URL, body, config)`
>- `axios.delete(URL, config)`


# Packages
Import Statement:
```js
import express from "express";
import bodyParser from "body-parser";
import axios from "axios";
```


> [!tip]+ Packages
> - [[Body Parser]]
> - [[Express]]
> - [[Axios]]


<hr />

```dataviewjs
dv.view("customJS/navWD")
```
